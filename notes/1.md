# 流程

利用 tsup 解析 ts 文件 并打包出 cjs 和 esm 格式 , 以 node/src/cli.ts 为入口

# cli 命令

src/node/cli.ts

# 什么是 DevServer

- 首先，Dev Server 本质上是一个开发阶段使用的 HTTP Server，它主要包含如下的作用:

对资源进行编译，然后将编译产物返回给浏览器

实现模块热更新，在文件改动时能推送更新到浏览器

静态资源服务，比如支持访问图片等静态资源

# 处理入口 HTML 文件

如何在访问时让 vite 响应入口 html 文件？

通过 node/plugin-island/indexHtml.ts 插件 在中间件返回 html 文件

# 渲染 React 组件

引入 react 和 react-dom

# 实现热更新

加上 transformIndexHtml 和 react plugin 就能实现热更新

关于为什么添加上 transformIndexHtml 和 react plugin 就能实现热更新

> In middleware mode, you should make sure your entry index.html file is transformed by Vite. Here's an example for an Express server:

# 解析配置文件

1. 找到配置文件路径 搜索 root 下 config.js 和 config.ts 即可
2. 解析配置文件
   借助 vite 提供的 loadConfigFromFile

# 实现客户端访问到服务端的数据

利用 vite 的虚拟模块

# 实现配置文件更新的热更新效果

重新 resolveconfig 后重启 devserver

- rosolveConfig 在 src/node/dev.js 进行解析, 然后在 createDevServer 时作为一个虚拟模块传给 Devserver， 所以我们需要重新执行这个函数
